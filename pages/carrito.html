<!DOCTYPE html>
<html>
<head>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
	<link rel="stylesheet" href="../css/style.css">

	<title>Carrito de compras</title>
	<style>
		.texto-derecha {
			text-align: right;
		}
	</style>
</head>
<body>
	<class="nav-superior">
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
          <a class="navbar-brand" href="../index.html">SPARTAN NUTRITION <img style="width: 40px; height: 40px;" src="../images/LOGO.png" alt=""></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              
            </ul>
            <form class="d-flex" role="search">
              <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
              <button class="btn btn-dark" type="submit">Search</button>
            </form>
          </div>
        </div>
      </nav>
      </nav>
	<h1 class="titulo-carrito">Carrito de compras</h1>
	<table class="table table-bordered">
		<thead>
			<tr>
				<th>Imagen</th>
				<th>Descripcion</th>
				<th>Precio Unitario</th>
				<th>Cantidad</th>
				<th>Precio Total</th>
			</tr>
		</thead>
		<tbody id="body-tabla">
			<tr id="producto-1">
				<td><img style="width: 120px; height: 120px;"  src="../images/esta-vacio.jpg" alt="Imagen del producto" id="imagen-producto0"></td>
				<td class="descripcion-producto">Descripcion del producto</td>
				<td class="precioUnitario">$10.00</td>
				<td class="cantidad"></td>
				<td class="subtotal">$10.00</td>
			</tr>
			
			
		</tbody>
		<tfoot>
			<tr>
				<td colspan="4" class="texto-derecha">Total:</td>
				<td id="total" class="precio-total">0</td>
			</tr>
		</tfoot>
	</table>
	<button class="btn btn-dark boton-principal" id="comprar">COMPRAR</button>
</body>
<script>

	// codigo para añadir nuevas filas a la tabla y añadir los elementos que tengo en el local storage

	document.getElementById('imagen-producto0').src=JSON.parse(localStorage.getItem('ProteinaCarrito0')).imagen
	document.getElementById("producto-1").children[1].innerHTML=JSON.parse(localStorage.getItem('ProteinaCarrito0')).name
	document.getElementById("producto-1").children[2].innerHTML=JSON.parse(localStorage.getItem('ProteinaCarrito0')).price
	document.getElementById("producto-1").children[3].innerHTML=parseInt(localStorage.getItem('CantidadProteina0'))
	
	function calcularPrecio(precioUnitario, cantidad) {
  		var precioTotal = precioUnitario * cantidad;
  		
		return precioTotal
  	} 

	  document.getElementById("producto-1").children[4].innerHTML=precioTotal=calcularPrecio(parseInt(document.getElementById("producto-1").children[2].innerHTML),parseInt(document.getElementById("producto-1").children[3].innerHTML))

	 document.getElementsByClassName('cantidad')[0].addEventListener("input",() =>{
		document.getElementById("producto-1").children[4].innerHTML=precioTotal=calcularPrecio(parseInt(document.getElementById("producto-1").children[2].innerHTML),parseInt(document.getElementById("producto-1").children[3].innerHTML))
	
	 })
	 
   function agregarTablas(){

	if(localStorage.length>3){
	   for (i=1; i<=(localStorage.length)/3; i++){
		var fila= document.createElement('tr');
		var columna1=document.createElement("td");
		var columna2=document.createElement("td");
		var columna3=document.createElement("td");
		var columna4=document.createElement("td");
		var columna5=document.createElement("td");
		columna1.innerHTML='<img style="width: 120px; height: 120px;"  src="" alt="Imagen del producto" id="imagen-producto'+i+'">'
		
		fila.appendChild(columna1);
		fila.appendChild(columna2);
		fila.appendChild(columna3);
		fila.appendChild(columna4);
		fila.appendChild(columna5);
		cuerpoTabla=document.getElementById("body-tabla")
		cuerpoTabla.appendChild(fila)
		document.getElementById('imagen-producto'+i).src=JSON.parse(localStorage.getItem('ProteinaCarrito'+i)).imagen
		columna2.innerHTML=JSON.parse(localStorage.getItem('ProteinaCarrito'+i)).name
		columna3.innerHTML=JSON.parse(localStorage.getItem('ProteinaCarrito'+i)).price
		columna4.innerHTML=parseInt(localStorage.getItem('CantidadProteina'+i))
		columna5.innerHTML=parseInt(columna3.innerHTML)*parseInt(localStorage.getItem('CantidadProteina'+i))
		columna3.classList.add("precioUnitario")
		columna5.classList.add("subtotal")
		
		
  
	
		

		

	   }

   } 
}

   
  


   agregarTablas()
// calculo total del valor de los producto
   function calculoTotal(){
	
	var suma=0 
	for(j=0;j<document.getElementsByClassName("subtotal").length;j++){
		suma=suma+parseInt(document.getElementsByClassName("subtotal")[j].innerHTML)
	}

	document.getElementsByClassName("precio-total")[0].innerHTML=parseInt(document.getElementsByClassName("precio-total")[0].innerHTML)+suma
   }

   calculoTotal()

   //borrando todo del localStorage

   document.getElementById("comprar").addEventListener("click",()=>{
		localStorage.clear()
		alert("gracias por tu compra :)")
		location.reload()
   })



</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
</html>


